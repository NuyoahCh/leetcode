# 官方链接
https://leetcode.cn/problems/power-grid-maintenance/description/?envType=daily-question&envId=2025-11-06

## 题解
https://leetcode.cn/problems/power-grid-maintenance/solutions/3824587/gomei-ri-yi-ti-by-code-review-f14w/

## Code
```go
type DSU struct {
    parent []int
}

func NewDSU(size int) *DSU {
    parent := make([]int, size)
    for i := range parent {
        parent[i] = i
    }
    return &DSU{parent: parent}
}

func (this *DSU) Find(x int) int {
    if this.parent[x] == x {
        return x
    }
    this.parent[x] = this.Find(this.parent[x])
    return this.parent[x]
}

func (this *DSU) Join(u, v int) {
    this.parent[this.Find(v)] = this.Find(u)
}

func processQueries(c int, connections [][]int, queries [][]int) []int {
    dsu := NewDSU(c + 1)
    
    for _, p := range connections {
        dsu.Join(p[0], p[1])
    }
    online := make([]bool, c+1)
    offlineCounts := make([]int, c+1)
    for i := range online {
        online[i] = true
    }
    
    minimumOnlineStations := make(map[int]int)
    for _, q := range queries {
        op, x := q[0], q[1]
        if op == 2 {
            online[x] = false
            offlineCounts[x]++
        }
    }
    
    for i := 1; i <= c; i++ {
        root := dsu.Find(i)
        if _, exists := minimumOnlineStations[root]; !exists {
            minimumOnlineStations[root] = -1
        }
        station := minimumOnlineStations[root]
        if online[i] {
            if station == -1 || station > i {
                minimumOnlineStations[root] = i
            }
        }
    }
    
    ans := []int{}
    for i := len(queries) - 1; i >= 0; i-- {
        op, x := queries[i][0], queries[i][1]
        root := dsu.Find(x)
        station := minimumOnlineStations[root]
        if op == 1 {
            if online[x] {
                ans = append(ans, x)
            } else {
                ans = append(ans, station)
            }
        }
        
        if op == 2 {
            if offlineCounts[x] > 1 {
                offlineCounts[x]--
            } else {
                online[x] = true
                if station == -1 || station > x {
                    minimumOnlineStations[root] = x
                }
            }
        }
    }
    
    for i, j := 0, len(ans)-1; i < j; i, j = i + 1, j - 1 {
        ans[i], ans[j] = ans[j], ans[i]
    }
    
    return ans
}
```